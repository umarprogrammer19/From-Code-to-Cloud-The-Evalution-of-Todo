# API Contract: Chat History Service

## Endpoints

### POST /api/{user_id}/conversations
Create or get existing conversation for a user

#### Request
```json
{
  "user_id": "string"
}
```

#### Response (200 OK)
```json
{
  "conversation_id": "uuid-string",
  "user_id": "string",
  "created_at": "timestamp",
  "updated_at": "timestamp"
}
```

### POST /api/{user_id}/conversations/{conversation_id}/messages
Add a message to a conversation

#### Request
```json
{
  "conversation_id": "uuid-string",
  "role": "user|assistant|tool",
  "content": "string",
  "tool_calls": {}
}
```

#### Response (201 Created)
```json
{
  "message_id": "uuid-string",
  "conversation_id": "uuid-string",
  "role": "user|assistant|tool",
  "content": "string",
  "tool_calls": {},
  "created_at": "timestamp"
}
```

### GET /api/{user_id}/conversations/{conversation_id}/messages
Get chat history for a conversation

#### Response (200 OK)
```json
{
  "conversation_id": "uuid-string",
  "messages": [
    {
      "message_id": "uuid-string",
      "role": "user|assistant|tool",
      "content": "string",
      "tool_calls": {},
      "created_at": "timestamp"
    }
  ]
}
```

## Data Models

### Conversation
```json
{
  "id": "uuid-string",
  "user_id": "string",
  "created_at": "timestamp",
  "updated_at": "timestamp"
}
```

### Message
```json
{
  "id": "uuid-string",
  "conversation_id": "uuid-string",
  "role": "user|assistant|tool",
  "content": "string",
  "tool_calls": {},
  "created_at": "timestamp",
  "updated_at": "timestamp"
}
```

## Error Responses

### 404 Not Found
```json
{
  "error": "Conversation not found",
  "code": "CONVERSATION_NOT_FOUND"
}
```

### 400 Bad Request
```json
{
  "error": "Invalid request parameters",
  "code": "INVALID_PARAMETERS"
}
```

### 500 Internal Server Error
```json
{
  "error": "An unexpected error occurred",
  "code": "INTERNAL_ERROR"
}
```